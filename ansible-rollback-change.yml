# rollback change
---
-
  hosts: localhost
  name: "rollback change with Ansible"
  tasks:
    -
      name: "rollback a change with Ansible task(s)"
      uri:
        url: "http://35.186.151.37/carts/1/items/promotion/0"
    -
      name: "send Dynatrace custom configuration event with business context information"
      uri:
        url: https://dwy90787.live.dynatrace.com/api/v1/events?Api-Token=dt0c01.HLULYHXSP3LD7MQJAVT45J2M.SFSTIFAZYKBR3B7SENEWIWOECPKHNVCKZHUTHIWJECGQZLN2BHQEH2273QNVIYQN
        method: POST
        headers:
          content-type: application/json
        body:
          eventType: CUSTOM_CONFIGURATION
          attachRules:
            tagRule:
            - meTypes:
              - SERVICE
              - PROCESS_GROUP_INSTANCE
              - HOST
              tags:
              - context: CONTEXTLESS
                key: "{{ configuration_tag_key }}"
                value: "{{ configuration_tag_value }}"
          source: Ansible Tower
          description: "{{ configuration_details }}"
          configuration: "{{ configuration_type }}"
          customProperties:
            Change Ticket: "{{ configuration_change_ticket }}"
            Change New: "{{ configuration_new }}"
            Change Old: "{{ configuration_old }}"
            Remediation: "{{ configuration_remediation }}"
        body_format: json
        status_code: 200
